agente008 = "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\n\
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\n\
NNNNNNNNNNNNNNNNNNNNNNNXXKKKKXXXNNNNNNNNNNNNNNNNNN\n\
XXXXXXXXXXXXXXXXXX0xdol:::;;;cdxkOKXXXXXXXXXXXXXXX\n\
XXXXXXXXXXXXXXX0o;,;c;....',;;:odxkOKXXXXXXXXXXXXX\n\
XXXXXXXXXXXXKd:..',,'..''''''''',codkKXXXXXXXXXXXX\n\
XXXXXXXXXXXk'..',::;lodxxxoc,'''',;,cdk0KXXXXXXXXX\n\
XXXXXXXXXXx....;,;oddxxkkkOOOdoool:,,cld0KXXXXXXXX\n\
XXXXXXXXX0.....',lxxxxkkO000000OOOkc,:clxKXXXXXXXX\n\
XXXXXXXXXo......,oxxxxkO0000000000Ok;':lkKXXXXXXXX\n\
XXXXXXXXXx. .  'oddoclc:ldO0000OO00O:',:KXXXXXXXXX\n\
KKKKKKKKKK';l;.:dxxdl;:llldOOxoclodx.';xKKKKKKKKKK\n\
KKKKKKKKKKc;xdcodxxkkxdddodOOdollcxk.'o0KKKKKKKKKK\n\
KKKKKKKKKKk.xkdooxkkkkOkxdxOKOOOO00xcOKKKKKKKKKKKK\n\
KKKKKKKKKKKl.'loddxkkOOkoodkkO00KK00KKKKKKKKKKKKKK\n\
000000000000l.:odxxxddol:codoxOO000000000000000000\n\
0000000000000'clodxdddooodxxoodxkO0000000000000000\n\
0000000000000xodoooooxkkkkkkOOkkk00000000000000000\n\
0000000000000OdxxxolloxxkOOOOOkk000000000000000000\n\
00000000000kcO0OkkxdolloooddxkO0000000000000000000\n\
0000000000d':0XXK0OkxxxxxxxkkOKKO00000000000000000\n\
000000Od;. .,0KXXXX0OOOOOOOO0XNkoO0000000000000000\n\
OOOdc'     ''dXXNNNNX0OOOkOKNNXlc;:lxOOOOOOOOOOOOO\n\
l,.        .',ONXXxlooooodx0NNOc:,....;okOOOOOOOOO\n\
            ',cxKKx',:::::c:dNx::....   .cOOOOOOOO\
"
        
agente042 = "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\n\
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\n\
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\n\
XXXXXXXXXXXXXXXXXXXXOdollooodkXXXXXXXXXXXXXXXXXXXX\n\
XXXXXXXXXXXXXXXXXXkc;:;,'';;;',lOXXXXXXXXXXXXXXXXX\n\
XXXXXXXXXXXXXXXX0c;,.',,,:c:;,''':kXXXXXXXXXXXXXXX\n\
XXXXXXXXXXXXXXXx;;'.cxkkkOOOkdl,..'cKXXXXXXXXXXXXX\n\
XXXXXXXXXXXXX0l,,;';xO0OOOOOOkkkd'..,0XXXXXXXXXXXX\n\
XXXXXXXXXXXX0;',,..cdxxkkkkxocllol...:XXXXXXXXXXXX\n\
XXXXXXXXXXXXk......:c;;:oxxoc;:ldx;'.;KXXXXXXXXXXX\n\
KKKKKKKKKKKKd.....:c:;ccoOkdlcldxko,,'lxKKKKKKKKKK\n\
KKKKKKKKKKKOc'...,xOkxxxk0Oxxxkkkkxc...'o0KKKKKKKK\n\
KKKKKKKKKkl;....',xkkxdldodddddxkkxl'..';cOKKKKKKK\n\
KKKKKKKKk:;'..',..lddolddlodddddkkl...';l0KKKKKKKK\n\
KKKK00kdlc;'''.....oddocdxxkddxxkx,...'ck0KKKKKKKK\n\
0000000xdoc,'..... .cdddooodxkkkd,.'.',cO000000000\n\
000000Oddol;,'..... .codxddxxkxl'.....',:odO000000\n\
000000Okdxc;,........:llooodxxdc'......;ok00000000\n\
0000000Oklc:'.......':looodxxxxoc;,,,;cdxxxxk0O000\n\
000000KOKOddo;,;;:loolloodddxkkxxxkkkkkkkkdO0O0000\n\
0000OXXXXK0O0kxxdxxxxxdddxxxkkkkkkkkOkkkkxkkk0OXXX\n\
000OX0kxKKK0K0kkkkkkkkkkkkkkkkkkOOOOOOOkxOkOOOd0KK\n\
OOKKOOkOOx00OOOOOOOOOkOOOOOOOOOOOOOOOOOkxxkKO00K0X\n\
O0NXKNOko00kOK00000OOOOOOOOOOOOOOOOOOOOkkO00K0kklO\
"

agente094 = "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\n\
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\n\
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\n\
XXXXXXXXXXXXXXXXXXXXKkooddldKKXXXXXXXXXXXXXXXXXXXX\n\
XXXXXXXXXXXXXXXXXOd,,''.'.'..',ckXXXXXXXXXXXXXXXXX\n\
XXXXXXXXXXXXXXXKl'','...........;0XXXXXXXXXXXXXXXX\n\
XXXXXXXXXXXXXXXx,;;:::clc::;,,'''cKXXXXXXXXXXXXXXX\n\
XXXXXXXXXXXXXXK::clodkkxxdoolcc:,,OXXXXXXXXXXXXXXX\n\
XXXXXXXXXXXXXXk;clookkkxxdoolccc;'xXXXXXXXXXXXXXXX\n\
XXXXXXXXXXXXXKo;:::c:;cddl:,,,,;;.:KXXXXXXXXXXXXXX\n\
XXXXXXXXXXXXXKx;:dcl;;ckx:,,',;::.cKXXXXXXXXXXXXXX\n\
KKKKKKKKKKKKKKx::ddxddkkxc:;::cl:,:KKKKKKKKKKKKKKK\n\
KKKKKKKKKKKKKKOc:oxkkxxdl;:::ccc;,kKKKKKKKKKKKKKKK\n\
KKKKKKKKKKKKKKKkldkkdlc,,'',;ccclkKKKKKKKKKKKKKKKK\n\
KKKKKKKKKKKKKKKK0odocclc:;,,,;::0KKKKKKKKKKKKKKKKK\n\
00000000000000000Oloodoc;;;:;;;k000000000000000000\n\
000000000000000000xlclol;;,,,;:O000000000000000000\n\
00000000000000000Oxdocc:,',,;:clo00000000000000000\n\
000000000000000Okldddddl:;;:::cc'lk000000000000000\n\
0000000000Okxdollllddddoc:::::::;;::oxk00000000000\n\
00000Okxdlllllcccll;coolc:;;,,;;;;;,;;;cldxO000000\n\
0Odolllcccccllcclcod';cccc:;;;:;;;,';;;;:::ccodO00\n\
dlllccccccccllccccc,,;:clooollc,,,,;;;;:::::::::oO\n\
cccc:cccc:cclcc:c::.;:cloddol:''',;;;;:;;;:::;;::l\n\
c::ccccccc:cccc::::,:;coodol:.''',,;;:;;;::;;;;;;;\
"

var c = document.getElementById('chatCanvas');
var ctx = c.getContext('2d');
var cw = c.width = 400;
var ch = c.height = 58;

ctx.font = 'normal 32px monospace';
ctx.textAlign = 'left';
ctx.textBaseline = 'top';
ctx.fillStyle = '#fff';
ctx.strokeStyle = 'rgba(0, 0, 0, .3)';
ctx.shadowColor = '#3f3';


var fileSystem = {
    '~': {
        'freesoftware.txt': 'Na década de 1960, um grupo de engenheiros e programadores, conhecidos como "hackers", convergiu em torno da ideia de que o compartilhamento de conhecimento e a colaboração eram essenciais para o avanço da tecnologia. Mas pode dizer-se que tudo começou quando Richard Stallman, um dos principais proponentes dessa cultura, lançou o livro "Free Software, Free Society", onde explora a importância do software livre não apenas como uma questão técnica, mas como um princípio ético que defende a liberdade e a autonomia do usuário. Neste contexto, Stallman argumenta que o software deve ser acessível a todos para que cada indivíduo possa não apenas usar, mas também estudar, modificar e distribuir programas, promovendo assim um ambiente de inovação e criatividade. A obra destaca como a cultura hacker, ao valorizar a cooperação e a troca de ideias, pode servir como um contrapeso às práticas monopolistas da indústria, garantindo que a tecnologia esteja a serviço da sociedade e não apenas de interesses comerciais.',

        'hackerschool.txt': 'Tudo começou no Taguspark, em 2012, quando um grupo de estudantes apaixonados por tecnologia decidiu criar um espaço onde pudessem dar vida às suas ideias mais inovadoras. A HackerSchool nasceu com a missão de promover a colaboração, a experimentação e a aprendizagem prática, inspirando-se na cultura hacker que valoriza a partilha de conhecimento e o desenvolvimento de soluções criativas para os desafios do mundo real. Aqui, estudantes de diversas áreas unem forças para construir projetos incríveis, desde a internet das coisas até à inteligência artificial, utilizando tecnologias de código aberto e materiais acessíveis. A HackerSchool é mais do que um clube de tecnologia: aqui impulsiona-se uma nova geração de criadores e inovadores.',

        'cifra_vigenere.txt': "mrgohfehyssorqaupwmjfq",

        'pista.txt': "Página 133",

        'enigma.txt': "Onde tudo começou, \nEncontra a chave que procuras, rodeada, \nE tudo começará para ti.",

        'xad0w.b1ts': {
            'acontecimentos_suspeitos.txt': "Suspeita-se que a xad0w.b1ts esteja por trás de alguns acontecimentos dos últimos tempos, como:\n\n\n\
\t- Aumento dos preços no Social\n\
\t- Crise da habitação em Portugal\n\
\t- A disciplina de cálculo III\n\
\t- A francesinha do técnico\n\
\t- As escadas rolantes do baixa-chiado não funcionarem\n\
\t- A app da GIRA\n\
\t- Leiria?\n\
\t- Os pombos do Arco do Cego\n\
\t- As cadeiras dos anfiteatros do central\n\
\t- A queda do Império Romano Bizentino\n\
\t- A ilha das cores é cancelada\n",
        
            'fotos_suspeitos': {
                'suspeito1.txt': agente008,

                'suspeito2.txt': agente042,

                'suspeito3.txt': agente094
            },
        
            /* 'logs.txt': "Alguns logs" */
        },

        '.cheats.txt': "Crazy, no técnico há sítios onde se guardam livros"
        
        // You can add more files here as needed
    }
};


let currentDir = fileSystem['~']; // Diretoria atual
let currentPath = '~'; // Caminho atual (só se usa no cd)
let parsedPath = '~'; // É o caminho que uso nas outras funções


function getPrompt() {
    return '[[;#6dba83;]guest@hackerschool:]' + "[[;#3465A4;]" + currentPath + ']$ ';
  }


function getDirectory(path) {
    let parts = path.split('/').filter(p => p.length > 0);
    let dir = fileSystem; 
    for (let part of parts) {
        if (dir[part]) {
            dir = dir[part];
        } else {
            return null;
        }
    }
    return dir;
}


function ls(arg) {
    output = "";
    if (arg === '-a'){
        for (const key of Object.keys(getDirectory(parsedPath))){
            if (typeof(currentDir[key]) !== 'string')
                output += "[[;#3465A4;#6dba83;]" + key + "]    ";            
            else
                output += key + "    "
        }
    }
    else{
        for (const key of Object.keys(getDirectory(parsedPath))){
            if (!key.startsWith('.')){
                if (typeof(currentDir[key]) !== 'string'){
                    output += "[[;#3465A4;#6dba83;]" + key + "]    ";   
                }         
                else
                    output += key + "    "
            }
        }
    }
    return output;
}


function cd(path) {
    if (parsedPath === null) {
        return "Diretório não encontrado";
    } else {
        path = parsedPath;
        currentDir = getDirectory(path);
        let parts = path.split('/').filter(p => p.length > 0);
        currentPath = parts.join('/');
    }
    return "";
}


function cat(fileName) {
    if (typeof(fileName) === 'string' && currentDir[fileName])
        return currentDir[fileName];
    else if (!currentDir[fileName])
        return "Ficheiro não encontrado";
    else
        return "cat: '" + fileName + "': É uma pasta"
}


function pathParser(path) {
    let parts = path.split('/').filter(p => p.length > 0);
    let parsedPath = [];
    let dir = fileSystem; 
    if (parts[0] !== '~')
        parsedPath.push("~");
    
    for (let part of parts) {
        if (part === '.')
            continue;
        else if (part === '..')
            parsedPath.pop();
        else
            parsedPath.push(part);
    }

    if (!parsedPath.length)
        return "~";

    for (let part of parsedPath) {
        if (dir[part]) 
            dir = dir[part];
        else 
            return null;
    }
    return parsedPath.join('/');
}


// Initialize the terminal
$('#terminal').terminal(function (command) {
    let cmd = command.split(' ');
    let arg1 = cmd[0];
    let arg2 = cmd[1] ? cmd[1] : "";
    
    if (arg1 === 'ls')
        this.echo(ls(arg2));
    else if (arg1 === 'cd'){
        let aux = cd(arg2);
        if (aux)
            this.echo(aux);
    }
    else if (arg1 === 'cat')
        this.echo(cat(arg2));
    else{
        this.echo('Comando não reconhecido.');
    }
}, {
    greetings: 'Muito bem, recruta! Conseguiste desbloquear a fase 1. Assim damos-te as boas vindas ao início da jornada.\n\n\
Para passares à próxima fase, tudo que precisas está nesta página, que é um emulador de terminal UNIX (um pouco limitado!). \n\
Lembra-te que a internet e agora o chatgpt estão sempre prontos para te ajudar. \n\n\
O ls é um comando que serve para mostrar que ficheiros e pastas estão num certo local do computador. \n\
Assim, a primeira pista é de borla: experimenta escrever ls e apertar enter a ver o que acontece!\n',
    prompt: getPrompt,   
    name: 'HackerSchool',
    promptExit: false
});










